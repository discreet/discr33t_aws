#kms_keys = <%= @kms_keys %>
#
#key_data = kms_client.list_aliases()
#
#key_list = []
#key_data.aliases.each do |key|
#  key_list << key.alias_name
#end
#
#kms_keys.each do |k,v|
#  unless key_list.include?('alias/<%= k %>')
#  kms_data = kms_client.create_key(
#    {
#      policy: '{
#        "Id": "<%= v['key_id'] %>",
#        "Version": "2012-10-17",
#        "Statement": [
#          {
#            "Sid": "Enable IAM User Permissions",
#            "Effect": "Allow",
#            "Principal": {
#              "AWS": [
#                "arn:aws:iam::949402414914:root"
#              ]
#            },
#            "Action": "kms:*",
#            "Resource": "*"
#          },
#          {
#            "Sid": "Allow access for Key Administrators",
#            "Effect": "Allow",
#            "Principal": {
#              "AWS": [
#              "<%= v['key_iam'] %>"
#              ]
#            },
#            "Action": [
#              "kms:Create*",
#              "kms:Describe*",
#              "kms:Enable*",
#              "kms:List*",
#              "kms:Put*",
#              "kms:Update*",
#              "kms:Revoke*",
#              "kms:Disable*",
#              "kms:Get*",
#              "kms:Delete*",
#              "kms:ScheduleKeyDeletion",
#              "kms:CancelKeyDeletion"
#            ],
#            "Resource": "*"
#          },
#          {
#            "Sid": "Allow use of the key",
#            "Effect": "Allow",
#            "Principal": {
#              "AWS": [
#              "<%= v['key_iam'] %>"
#              ]
#            },
#            "Action": [
#              "kms:Encrypt",
#              "kms:Decrypt",
#              "kms:ReEncrypt*",
#              "kms:GenerateDataKey*",
#              "kms:DescribeKey"
#            ],
#            "Resource": "*"
#          },
#          {
#            "Sid": "Allow attachment of persistent resources",
#            "Effect": "Allow",
#            "Principal": {
#              "AWS": [
#	        "<%= v['key_iam'] %>"
#              ]
#            },
#            "Action": [
#              "kms:CreateGrant",
#              "kms:ListGrants",
#              "kms:RevokeGrant"
#            ],
#            "Resource": "*",
#            "Condition": {
#              "Bool": {
#                "kms:GrantIsForAWSResource": true
#              }
#            }
#          }
#        ]
#      }',
#      description: '<%= v['key_descr'] %>',
#      key_usage: 'ENCRYPT_DECRYPT',
#      origin: 'AWS_KMS'
#    }
#  )
#
#  key_arn = kms_data.key_metadata.arn
#
#  kms_client.create_alias (
#    {
#      alias_name: 'alias/<%= v['key_alias'] %>',
#      target_key_id: key_arn
#    }
#  )
#end
